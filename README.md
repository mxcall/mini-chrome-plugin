## 背景
发现chrome插件能 "沙箱逃逸", 即能访问到沙盒外面的localhost:xxx网络(从keepassHttp插件观察到的);   
所以尝试用Qoder新建前后端尝试, 在chrome_104版本中测试成功!!!

## 需求
我需要开发一个前后端程序, 功能是前端通过Chrome插件弹出菜单上传一个文件后, 通过http请求, 发送给 python后端; 具体细节如下:
1. 前端需要开发Chrome(v104版本)插件, 我可以通过Chrome的开发者模式加载开发的插件, 点击插件图标会弹出一个表单, 表单可以上传一个文件;点击提交后, 会通过localhost:19666请求发送给后端;
2. 后端需要开发python程序, 监听localhost:19666端口, 接收前端发送的文件, 注意文件一般有2G左右, 接受到的文件以原始上传的文件名存储,若重名则重命名为原始名称_年月日时分秒;
3. 文件上传成功后, 后端返回一个json数据, 包含文件名和文件大小;

## 项目结构

```
.
├── chrome-extension/          # Chrome 插件目录
│   ├── manifest.json         # 插件配置文件
│   ├── popup.html            # 弹出界面
│   ├── popup.js              # 交互逻辑
│   ├── popup.css             # 样式文件
│   └── icon.png              # 插件图标
├── main.py                   # Python 后端服务
├── pyproject.toml            # Python 项目配置
└── README.md                 # 本文件
```

## 使用说明

### 1. 启动后端服务

#### 安装依赖

首先确保已安装 Python >= 3.8.20,然后安装依赖:

```bash
# 如果使用 uv (推荐)
uv sync

# 或者使用 pip
pip install flask flask-cors
```

#### 运行后端

```bash
python main.py
```

成功启动后,你会看到类似以下信息:

```
文件上传服务启动中...
监听地址: localhost:19666
文件保存目录: C:\xxx\uploads
按 Ctrl+C 停止服务
 * Running on http://localhost:19666
```

上传的文件将保存在 `uploads` 目录中。

### 2. 安装 Chrome 插件

#### 步骤:

1. 打开 Chrome 浏览器
2. 在地址栏输入: `chrome://extensions/`
3. 打开右上角的「开发者模式」开关
4. 点击「加载已解压的扩展程序」按钮
5. 选择项目中的 `chrome-extension` 目录
6. 插件安装成功后,会在浏览器工具栏显示插件图标

### 3. 使用插件上传文件

1. **点击插件图标**:在浏览器工具栏点击文件上传插件图标
2. **选择文件**:在弹出的窗口中点击文件选择框,选择要上传的文件
3. **上传文件**:选择文件后,点击「上传文件」按钮
4. **查看结果**:上传成功后会显示文件名和文件大小

### 4. 功能特性

- ✅ 支持上传大文件(约 2GB)
- ✅ 自动处理文件名冲突(添加时间戳)
- ✅ 实时显示上传状态
- ✅ 美观的用户界面
- ✅ 完整的错误提示

### 5. 文件命名规则

- 如果上传的文件名不存在,直接使用原始文件名保存
- 如果文件名已存在,自动重命名为: `原始文件名_年月日时分秒.扩展名`
- 例如: `test.txt` 重复时会保存为 `test_20251107153025.txt`

### 6. API 接口说明

#### 上传接口

- **地址**: `http://localhost:19666/upload`
- **方法**: POST
- **请求格式**: multipart/form-data
- **请求参数**:
  - `file`: 文件对象

#### 成功响应示例

```json
{
  "status": "success",
  "filename": "example.txt",
  "filesize": 1048576
}
```

#### 错误响应示例

```json
{
  "status": "error",
  "message": "错误描述信息"
}
```

### 7. 注意事项

- 后端服务必须先启动,插件才能正常上传文件
- 确保 localhost:19666 端口未被其他程序占用
- 上传大文件时请耐心等待,不要关闭浏览器窗口
- Chrome 插件仅在开发者模式下加载有效

### 8. 故障排除

#### 上传失败提示"请确保后端服务正在运行"

- 检查后端服务是否已启动
- 确认服务监听在 localhost:19666 端口
- 检查防火墙是否阻止了本地连接

#### 插件无法加载

- 确认已开启 Chrome 开发者模式
- 检查 `chrome-extension` 目录中的文件是否完整
- 查看 Chrome 扩展程序页面是否有错误提示

#### 文件上传后找不到

- 检查后端服务启动时显示的文件保存目录
- 默认保存在项目根目录的 `uploads` 文件夹中

## 技术栈

### 后端
- Python 3.8+
- Flask (Web 框架)
- Flask-CORS (跨域支持)

### 前端
- HTML5
- CSS3
- JavaScript (ES6+)
- Chrome Extension Manifest V3

## 开发信息

- 项目版本: 1.0.0
- Chrome 兼容版本: v104+
- Python 要求版本: >= 3.8.20
